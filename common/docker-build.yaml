- job:
    name: docker-build
    node: docker-builder
    builders:
      - shell:
          !include-raw './scripts/docker-build.sh'
      - trigger-builds:
        - project: 'docker-publish'
          current-parameters: true
    description: |
      This job will use docker builder host and build an image from the given git url.
      Job 'docker-publish' is triggered after this one to publish image to registries.
    concurrent: true
    parameters:
        - string:
            name: URL
            description: 'GIT repository with image'
        - string:
            name: NAME
            description: 'destination repository name (without "infra-" prefix)'
        - string:
            name: TAG
            description: 'destination repository tag'
        - string:
            name: REGISTRY_URLS
            default: 'registry.fuel-infra.org'
            description: 'space separated list of <hostname>:<port> pairs'
    wrappers:
      - timeout:
          fail: true
          timeout: 5
