- job-template:
    # Downloads ISO image via magnet link
    # deploing using group and runs tempest
    #
    # specification
    #     Name of the job.
    # group
    #     Test group used as --group parameter in system_test.sh
    #     For tempest used groups from mos-ci-deployment-scripts
    # test-group
    #     Human readable description of configuration (for testrail)
    # description
    #     Job description
    # node
    #     Jenkins slave label
    # venvpath
    #     Path to virtual env with fuel-devops installed (VENV_PATH)
    # display-name
    #     Job display-name

    name: 7.0.tempest.{specification}
    project-type: freestyle
    defaults: global
    disabled: false
    concurrent: false
    node: '{node}'
    description: |
      DO NOT TRIGGER THIS JOB. Use 7.0.tempest.on_node instead
      {description}
    display-name: '{display-name}'
    retry-count: 2
    logrotate:
      daysToKeep: 5
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    properties:
    - heavy-job:
        weight: 7
    builders:
      - trigger-builds:
        - project: '7.0.tempest.create_env'
          same-node: true
          block: true
          predefined-parameters: |
            OPENSTACK_RELEASE=ubuntu
            ENABLE_PROPOSED=$ENABLE_PROPOSED
            ENABLE_SECURITY=$ENABLE_SECURITY
            ENABLE_UPDATES=$ENABLE_UPDATES
            ENABLE_UPDATE_CENTOS=$ENABLE_UPDATE_CENTOS
            ERASE_PREV_ENV=$ERASE_PREV_ENV
            SKIP_INSTALL_ENV=$SKIP_INSTALL_ENV
            DISABLE_SSL=$DISABLE_SSL
            ENV_NAME=7.0.tempest.{specification}.$BUILD_ID
            FILE=test_tempest_7_0.py
            GROUP={group}
            FUEL_QA_VER=$FUEL_QA_VER
            SLAVE_NODE_MEMORY=10240
      - trigger-builds:
        - project: 'maintenance-tempest-runner'
          same-node: true
          block: true
          block-thresholds:
            build-step-failure-threshold: 'never'
          predefined-parameters: |
            REPORT_PREFIX=/home/jenkins/report-rally-tempest
            ENV_NAME=7.0.tempest.{specification}.$BUILD_ID
            SNAPSHOT_NAME={group}
            MILESTONE=7.0
            VENV_PATH=/home/jenkins/qa-venv-7.0
            TEMPEST_RUNNER=$TEMPEST_RUNNER
      - trigger-builds:
        - project: 'maintenance-tempest-reports-Testrail'
          same-node: true
          block: true
          block-thresholds:
            build-step-failure-threshold: 'never'
          predefined-parameters: |
            REPORT_PREFIX=/home/jenkins/report-rally-tempest
            ENV_NAME=7.0.tempest.{specification}.$BUILD_ID
            SNAPSHOT_NAME={group}
            MILESTONE=7.0
            REPORT_FILE=verification.xml
            TESTRAIL_PLAN_NAME=$TESTRAIL_PLAN_NAME
            TEST_GROUP={test-group}
            SUITE=Tempest 7.0
            ADD_TIMESTAMP=$ADD_TIMESTAMP

- project:
    name: 7.0.tempest.vlan.ceph
    display-name: 7.0.tempest.vlan.ceph
    specification: vlan.ceph
    group: tempest_ceph_services_vlan
    test-group: VLAN+ENABLED_CEPH+ENABLED+SERVICES
    description: VLAN+CEPH+SERVICES UBUNTU TEMPEST tests (7.0 maintenance)
    node: maintenance-tempest
    jobs:
      - '7.0.tempest.{specification}'

- project:
    name: 7.0.tempest.tun.ceph
    display-name: 7.0.tempest.tun.ceph
    specification: tun.ceph
    group: tempest_ceph_services_tun
    test-group: TUN+ENABLED_CEPH+ENABLED+SERVICES
    description: TUN+CEPH+SERVICES UBUNTU TEMPEST tests (7.0 maintenance)
    node: maintenance-tempest
    jobs:
      - '7.0.tempest.{specification}'

- project:
    name: 7.0.tempest.vlan.non_ceph
    display-name: 7.0.tempest.vlan.non_ceph
    specification: vlan.non_ceph
    group: tempest_cinder_glance_swift_vlan
    test-group: VLAN+DISABLED_CEPH
    description: VLAN+DISABLED_CEPH UBUNTU TEMPEST tests (7.0 maintenance)
    node: maintenance-tempest
    jobs:
      - '7.0.tempest.{specification}'

- project:
    name: 7.0.tempest.tun.non_ceph
    display-name: 7.0.tempest.tun.non_ceph
    specification: tun.non_ceph
    group: tempest_cinder_glance_swift_tun
    test-group: TUN+DISABLED_CEPH
    description: TUN+DISABLED_CEPH UBUNTU TEMPEST tests (7.0 maintenance)
    node: maintenance-tempest
    jobs:
      - '7.0.tempest.{specification}'

