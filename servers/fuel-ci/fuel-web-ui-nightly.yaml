- job:
    name: 'fuel-web-ui-nightly'
    builders:
      - inject:
          properties-content: |
            NPM_CONFIG_PREFIX=/home/jenkins/npm
            VENV_CLEANUP=true
      - shell:
          !include-raw-escape builders/verify-fuel-web-ui.sh
    description: |
      Test requests for fuel-web UI (npm run lint && npm test) master branch

      Uses venv with python2.7
    node: verify-fuel-web-ui
    concurrent: true
    properties:
      - heavy-job:
          weight: 1
      - throttle:
          categories:
            - one-nailgun-db-per-node
          max-per-node: 1
          option: category
    publishers:
      - description-setter:
          regexp-for-failed: '(Failed tests: (.*))'
      - archive:
          allow-empty: true
          artifacts: 'nailgun/test_run/ui_func/*.png, nailgun/test_run/ui_func/app.log'
          latest-only: false
    scm:
      - git:
          branches:
            - 'master'
          remotes:
            - gerrit:
                url: https://review.openstack.org/openstack/fuel-web.git
          choosing-strategy: 'default'
    triggers:
      - timed: '@midnight'
    wrappers:
      - ansicolor:
          colormap: css
      - timeout:
          fail: true
          write-description: true
          timeout: 45