- job-template:
    name: '{mos_version}-pkg-massrebuild-starter-{os}'
    concurrent: false
    node: '{systest-node}'
    parameters:
      - text:
          name: PACKAGE_LIST
          default: |
              ceilometer
              ceilometermiddleware
              cinder
              django_openstack_auth
              glance
              glance_store
              heat
              horizon
              ironic
              keystone
              keystonemiddleware
              mistral
              murano
              murano-dashboard
              neutron
              neutron-fwaas
              neutron-lbaas
              neutron-vpnaas
              nova
              os-apply-config
              os-brick
              os-client-config
              os-cloud-config
              os-collect-config
              oslo.cache
              oslo.concurrency
              oslo.config
              oslo.context
              oslo.db
              oslo.i18n
              oslo.log
              oslo.messaging
              oslo.middleware
              oslo.policy
              oslo.reports
              oslo.rootwrap
              oslo.serialization
              oslo.service
              oslosphinx
              oslotest
              oslo.utils
              oslo.versionedobjects
              oslo.vmware
              os-net-config
              os-refresh-config
              os-testr
              python-barbicanclient
              python-ceilometerclient
              python-cinderclient
              python-congressclient
              python-designateclient
              python-glanceclient
              python-heatclient
              python-ironicclient
              python-keystoneclient
              python-magnumclient
              python-manilaclient
              python-mistralclient
              python-muranoclient
              python-neutronclient
              python-novaclient
              python-openstackclient
              python-saharaclient
              python-swiftclient
              python-troveclient
              python-zaqarclient
              sahara
              swift
    builders:
      - shell: |
          #!/bin/bash
          rm -f properties-*
          for x in ${{PACKAGE_LIST}}
          do
              package=$(echo "$x" | awk -F @ '{{print $1}}')
              propfile="properties-$package"
              echo "PACKAGENAME=$package" > "$propfile"
          done

      - trigger-builds:
          - project: '{mos_version}-pkg-massrebuild-{os}'
            block: true
            parameter-factories:
              - factory: filebuild
                file-pattern: properties-*
                no-files-found-action: FAIL
            block: true
            block-thresholds:
              build-step-failure-threshold: never
