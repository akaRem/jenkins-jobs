- job:
    name: 'cve_tracking'
    node: 'cve-tracking'
    logrotate:
        daysToKeep: 10

    description: |
      <h3> Tracking of CVE in Mirants forked packages <h3>
      <p>
        <ul>
          <li><b>Owner:</b>Linux team</li>
          <li><b>Contacts:</b>#infra</li>
        </ul>
      </p>
      <p>
        <a href="http://cve-slave01-bud.infra.mirantis.net/html">Generated HTML pages</a>
      </p>

    parameters:
      - string:
          name: BRANCH
          default: 'master'
          description: "Branch for CVE tracking code"
      - bool:
          name: CLEAN
          default: false
          description: "Clean internal data structures, including database!"
#      - string:
#          name: CVE_NAME
#          default: ''
#          description: "Name of CVE"
#      - file:
#          name: packages_list
#          description: "File with list of packages to check"

    wrappers:
      - build-timeout:
          timeout: 50
      - ssh-agent-credentials:
          users:
            - '{ssh-creds-openstack-ci-jenkins}'

    properties:
      - authorization:
           mos-security-eng:
             - job-build
             - job-cancel
             - job-configure
             - job-discover
             - job-extended-read
             - job-read

    triggers:
      - timed: "H */6 * * *"

    builders:
      - shell:
          !include-raw: builders/cve_tracking.sh

    publishers:
      - email:
          recipients: 'ci+alert@mirantis.com'
          notify-every-unstable-build: false
          send-to-individuals: false
